{% extends 'mfc/base.html' %}

{% block title %}–°–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ - –ú–§–¶{% endblock %}

{% block content %}
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2>–°–ø–∏—Å–æ–∫ —É—Å–ª—É–≥</h2>
        <a href="{% url 'mfc:service_create' %}" class="btn btn-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É</a>
    </div>

    <!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ -->
    <form method="get" style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 4px;">
        <div style="display: grid; grid-template-columns: 2fr 1fr auto; gap: 10px; align-items: end;">
            <div class="form-group" style="margin-bottom: 0;">
                <label for="search">–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é:</label>
                <input type="text" name="search" id="search" class="form-control" 
                       value="{{ search_query }}" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏...">
            </div>
            <div class="form-group" style="margin-bottom: 0;">
                <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                <select name="category" id="category" class="form-control">
                    <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                    {% for category in categories %}
                        <option value="{{ category.id }}" {% if selected_category == category.id|stringformat:"s" %}selected{% endif %}>
                            {{ category.name }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <button type="submit" class="btn btn-primary">üîç –ù–∞–π—Ç–∏</button>
                <a href="{% url 'mfc:service_list' %}" class="btn btn-secondary">–°–±—Ä–æ—Å–∏—Ç—å</a>
            </div>
        </div>
    </form>

    {% if services %}
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                    <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                    <th>–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for service in services %}
                    <tr>
                        <td>{{ service.id }}</td>
                        <td>
                            <a href="{% url 'mfc:service_detail' service.pk %}" style="color: #667eea; text-decoration: none;">
                                {{ service.name }}
                            </a>
                        </td>
                        <td>{{ service.category.name }}</td>
                        <td>{{ service.duration_days }} –¥–Ω.</td>
                        <td>
                            <a href="{% url 'mfc:service_detail' service.pk %}" class="btn btn-primary" style="padding: 5px 10px; font-size: 12px;">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä</a>
                            <a href="{% url 'mfc:service_update' service.pk %}" class="btn btn-success" style="padding: 5px 10px; font-size: 12px;">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                            <a href="{% url 'mfc:service_delete' service.pk %}" class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
        {% if is_paginated %}
            <div style="margin-top: 20px; text-align: center;">
                {% if page_obj.has_previous %}
                    <a href="?page=1{% if search_query %}&search={{ search_query }}{% endif %}{% if selected_category %}&category={{ selected_category }}{% endif %}" class="btn btn-secondary">¬´ –ü–µ—Ä–≤–∞—è</a>
                    <a href="?page={{ page_obj.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if selected_category %}&category={{ selected_category }}{% endif %}" class="btn btn-secondary">‚Äπ –ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
                {% endif %}
                
                <span style="padding: 0 15px;">
                    –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ page_obj.paginator.num_pages }}
                </span>
                
                {% if page_obj.has_next %}
                    <a href="?page={{ page_obj.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if selected_category %}&category={{ selected_category }}{% endif %}" class="btn btn-secondary">–°–ª–µ–¥—É—é—â–∞—è ‚Ä∫</a>
                    <a href="?page={{ page_obj.paginator.num_pages }}{% if search_query %}&search={{ search_query }}{% endif %}{% if selected_category %}&category={{ selected_category }}{% endif %}" class="btn btn-secondary">–ü–æ—Å–ª–µ–¥–Ω—è—è ¬ª</a>
                {% endif %}
            </div>
        {% endif %}
    {% else %}
        <div class="empty-state">
            <p>–£—Å–ª—É–≥–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>
            <a href="{% url 'mfc:service_create' %}" class="btn btn-success" style="margin-top: 15px;">–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—É—é —É—Å–ª—É–≥—É</a>
        </div>
    {% endif %}
</div>
{% endblock %}

